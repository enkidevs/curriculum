---
author: jfarmer

levels:

  - beginner

  - basic

  - medium

  - advanced

type: normal

category: how to



parent: the-heap-data-structure

---

# Inserting Data Into a Heap With The `upheap` Operation

---
## Content

How do we insert information into a heap efficiently? Consider the following (binary) max-heap:

![upheap1](%3Csvg%20width%3D%22100%25%22%20height%3D%22auto%22%20viewBox%3D%220%200%20700%20300%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Ctitle%3EArtboard%3C%2Ftitle%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M349%2090c19.329966%200%2035-15.6700338%2035-35%200-6.7781994-1.926799-13.1063707-5.262556-18.4666731C372.560339%2026.6072003%20361.551767%2020%20349%2020c-19.329966%200-35%2015.6700338-35%2035s15.670034%2035%2035%2035zM209%20190c19.329966%200%2035-15.670034%2035-35%200-6.778199-1.926799-13.106371-5.262556-18.466673C232.560339%20126.6072%20221.551767%20120%20209%20120c-19.329966%200-35%2015.670034-35%2035s15.670034%2035%2035%2035zm-93%2090c19.329966%200%2035-15.670034%2035-35%200-6.778199-1.926799-13.106371-5.262556-18.466673C139.560339%20216.6072%20128.551767%20210%20116%20210c-19.3299662%200-35%2015.670034-35%2035s15.6700338%2035%2035%2035zm373-90c19.329966%200%2035-15.670034%2035-35%200-6.778199-1.926799-13.106371-5.262556-18.466673C512.560339%20126.6072%20501.551767%20120%20489%20120c-19.329966%200-35%2015.670034-35%2035s15.670034%2035%2035%2035z%22%20stroke%3D%22currentColor%22%20stroke-width%3D%222%22%2F%3E%3Ctext%20font-family%3D%22RobotoMono-Light%2C%20Roboto%20Mono%22%20font-size%3D%2240%22%20font-weight%3D%22300%22%20fill%3D%22currentColor%22%3E%3Ctspan%20x%3D%22464.996094%22%20y%3D%22171%22%3E36%3C%2Ftspan%3E%3C%2Ftext%3E%3Ctext%20font-family%3D%22RobotoMono-Light%2C%20Roboto%20Mono%22%20font-size%3D%2240%22%20font-weight%3D%22300%22%20fill%3D%22currentColor%22%3E%3Ctspan%20x%3D%22184.996094%22%20y%3D%22171%22%3E19%3C%2Ftspan%3E%3C%2Ftext%3E%3Ctext%20font-family%3D%22RobotoMono-Light%2C%20Roboto%20Mono%22%20font-size%3D%2240%22%20font-weight%3D%22300%22%20fill%3D%22currentColor%22%3E%3Ctspan%20x%3D%2291.9960938%22%20y%3D%22261%22%3E17%3C%2Ftspan%3E%3C%2Ftext%3E%3Ctext%20font-family%3D%22RobotoMono-Light%2C%20Roboto%20Mono%22%20font-size%3D%2236%22%20font-weight%3D%22300%22%20fill%3D%22currentColor%22%3E%3Ctspan%20x%3D%22316.594727%22%20y%3D%2269%22%3E100%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20d%3D%22M324.305402%2081L231%20127.270754M375%2081l89.005263%2049.575516M141%20220l43.724368-39%22%20stroke%3D%22currentColor%22%20stroke-width%3D%222%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E)

Remember, that we need to maintain two properties of the tree to ensure we have a heap:

1. The tree is a *complete* binary tree[1]
2. The parent node of a key is always greater than or equal to the key itself

To respect property (1), we will insert the new data in the correct spot.  To respect property (2), we will move around nodes in the tree after inserting the new data in the correct spot.

Let's say we want to insert the key `120`.  We would start by inserting it in the next available spot, like so:

![upheap2](%3Csvg%20width%3D%22100%25%22%20height%3D%22auto%22%20viewBox%3D%220%200%20700%20300%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Ctitle%3EArtboard%3C%2Ftitle%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M349%2090c19.329966%200%2035-15.6700338%2035-35%200-6.7781994-1.926799-13.1063707-5.262556-18.4666731C372.560339%2026.6072003%20361.551767%2020%20349%2020c-19.329966%200-35%2015.6700338-35%2035s15.670034%2035%2035%2035zM209%20190c19.329966%200%2035-15.670034%2035-35%200-6.778199-1.926799-13.106371-5.262556-18.466673C232.560339%20126.6072%20221.551767%20120%20209%20120c-19.329966%200-35%2015.670034-35%2035s15.670034%2035%2035%2035zm-93%2090c19.329966%200%2035-15.670034%2035-35%200-6.778199-1.926799-13.106371-5.262556-18.466673C139.560339%20216.6072%20128.551767%20210%20116%20210c-19.3299662%200-35%2015.670034-35%2035s15.6700338%2035%2035%2035zm373-90c19.329966%200%2035-15.670034%2035-35%200-6.778199-1.926799-13.106371-5.262556-18.466673C512.560339%20126.6072%20501.551767%20120%20489%20120c-19.329966%200-35%2015.670034-35%2035s15.670034%2035%2035%2035z%22%20stroke%3D%22currentColor%22%20stroke-width%3D%222%22%2F%3E%3Ctext%20font-family%3D%22RobotoMono-Light%2C%20Roboto%20Mono%22%20font-size%3D%2240%22%20font-weight%3D%22300%22%20fill%3D%22currentColor%22%3E%3Ctspan%20x%3D%22464.996094%22%20y%3D%22171%22%3E36%3C%2Ftspan%3E%3C%2Ftext%3E%3Ctext%20font-family%3D%22RobotoMono-Light%2C%20Roboto%20Mono%22%20font-size%3D%2240%22%20font-weight%3D%22300%22%20fill%3D%22currentColor%22%3E%3Ctspan%20x%3D%22184.996094%22%20y%3D%22171%22%3E19%3C%2Ftspan%3E%3C%2Ftext%3E%3Ctext%20font-family%3D%22RobotoMono-Light%2C%20Roboto%20Mono%22%20font-size%3D%2240%22%20font-weight%3D%22300%22%20fill%3D%22currentColor%22%3E%3Ctspan%20x%3D%2291.9960938%22%20y%3D%22261%22%3E17%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20d%3D%22M305%20280c19.329966%200%2035-15.670034%2035-35%200-6.778199-1.926799-13.106371-5.262556-18.466673C328.560339%20216.6072%20317.551767%20210%20305%20210c-19.329966%200-35%2015.670034-35%2035s15.670034%2035%2035%2035z%22%20stroke%3D%22currentColor%22%20stroke-width%3D%222%22%20fill%3D%22%23FFF%22%2F%3E%3Ctext%20font-family%3D%22RobotoMono-Light%2C%20Roboto%20Mono%22%20font-size%3D%2238%22%20font-weight%3D%22300%22%20fill%3D%22currentColor%22%3E%3Ctspan%20x%3D%22270.794434%22%20y%3D%22260%22%3E120%3C%2Ftspan%3E%3C%2Ftext%3E%3Ctext%20font-family%3D%22RobotoMono-Light%2C%20Roboto%20Mono%22%20font-size%3D%2236%22%20font-weight%3D%22300%22%20fill%3D%22currentColor%22%3E%3Ctspan%20x%3D%22316.594727%22%20y%3D%2269%22%3E100%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20d%3D%22M324.305402%2081L231%20127.270754M375%2081l89.005263%2049.575516M141%20220l43.724368-39m50.005479-1.977491l46.072795%2041.367311%22%20stroke%3D%22currentColor%22%20stroke-width%3D%222%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E)

But now the tree no longer satisfies the property (2) — the heap property — since `120` is greater than `19`.  To ensure that we respect the heap property, we compare `120` to its parent and swap the two if `120` is greater.  We continue doing this until `120` is in the root position or is less than its parent node.

This operation is sometimes called the `shift-up` or `upheap` operation.  Here's how it would look in this instance

Since `120` is greater than `19`, we would swap the two:

![upheap3](%3Csvg%20width%3D%22100%25%22%20height%3D%22auto%22%20viewBox%3D%220%200%20700%20300%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Ctitle%3EArtboard%3C%2Ftitle%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M349%2090c19.329966%200%2035-15.6700338%2035-35%200-6.7781994-1.926799-13.1063707-5.262556-18.4666731C372.560339%2026.6072003%20361.551767%2020%20349%2020c-19.329966%200-35%2015.6700338-35%2035s15.670034%2035%2035%2035z%22%20stroke%3D%22currentColor%22%20stroke-width%3D%222%22%2F%3E%3Cpath%20d%3D%22M209%20190c19.329966%200%2035-15.670034%2035-35%200-6.778199-1.926799-13.106371-5.262556-18.466673C232.560339%20126.6072%20221.551767%20120%20209%20120c-19.329966%200-35%2015.670034-35%2035s15.670034%2035%2035%2035z%22%20stroke%3D%22currentColor%22%20stroke-width%3D%222%22%20fill%3D%22%23FFF%22%2F%3E%3Cpath%20d%3D%22M116%20280c19.329966%200%2035-15.670034%2035-35%200-6.778199-1.926799-13.106371-5.262556-18.466673C139.560339%20216.6072%20128.551767%20210%20116%20210c-19.3299662%200-35%2015.670034-35%2035s15.6700338%2035%2035%2035zm373-90c19.329966%200%2035-15.670034%2035-35%200-6.778199-1.926799-13.106371-5.262556-18.466673C512.560339%20126.6072%20501.551767%20120%20489%20120c-19.329966%200-35%2015.670034-35%2035s15.670034%2035%2035%2035z%22%20stroke%3D%22currentColor%22%20stroke-width%3D%222%22%2F%3E%3Ctext%20font-family%3D%22RobotoMono-Light%2C%20Roboto%20Mono%22%20font-size%3D%2240%22%20font-weight%3D%22300%22%20fill%3D%22currentColor%22%3E%3Ctspan%20x%3D%22464.996094%22%20y%3D%22171%22%3E36%3C%2Ftspan%3E%3C%2Ftext%3E%3Ctext%20font-family%3D%22RobotoMono-Light%2C%20Roboto%20Mono%22%20font-size%3D%2238%22%20font-weight%3D%22300%22%20fill%3D%22currentColor%22%3E%3Ctspan%20x%3D%22174.794434%22%20y%3D%22170%22%3E120%3C%2Ftspan%3E%3C%2Ftext%3E%3Ctext%20font-family%3D%22RobotoMono-Light%2C%20Roboto%20Mono%22%20font-size%3D%2240%22%20font-weight%3D%22300%22%20fill%3D%22currentColor%22%3E%3Ctspan%20x%3D%2291.9960938%22%20y%3D%22261%22%3E17%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20d%3D%22M305%20280c19.329966%200%2035-15.670034%2035-35%200-6.778199-1.926799-13.106371-5.262556-18.466673C328.560339%20216.6072%20317.551767%20210%20305%20210c-19.329966%200-35%2015.670034-35%2035s15.670034%2035%2035%2035z%22%20stroke%3D%22currentColor%22%20stroke-width%3D%222%22%2F%3E%3Ctext%20font-family%3D%22RobotoMono-Light%2C%20Roboto%20Mono%22%20font-size%3D%2238%22%20font-weight%3D%22300%22%20fill%3D%22currentColor%22%3E%3Ctspan%20x%3D%22282.196289%22%20y%3D%22260%22%3E19%3C%2Ftspan%3E%3C%2Ftext%3E%3Ctext%20font-family%3D%22RobotoMono-Light%2C%20Roboto%20Mono%22%20font-size%3D%2236%22%20font-weight%3D%22300%22%20fill%3D%22currentColor%22%3E%3Ctspan%20x%3D%22316.594727%22%20y%3D%2269%22%3E100%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20d%3D%22M324.305402%2081L231%20127.270754M375%2081l89.005263%2049.575516M141%20220l43.724368-39m50.005479-1.977491l46.072795%2041.367311%22%20stroke%3D%22currentColor%22%20stroke-width%3D%222%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E)

However, `120` is still greater than `100`, so we must swap those two keys as well:

![upheap4](%3Csvg%20width%3D%22100%25%22%20height%3D%22auto%22%20viewBox%3D%220%200%20700%20300%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Ctitle%3EArtboard%3C%2Ftitle%3E%3Cg%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cpath%20d%3D%22M349%2090c19.329966%200%2035-15.6700338%2035-35%200-6.7781994-1.926799-13.1063707-5.262556-18.4666731C372.560339%2026.6072003%20361.551767%2020%20349%2020c-19.329966%200-35%2015.6700338-35%2035s15.670034%2035%2035%2035z%22%20stroke%3D%22currentColor%22%20stroke-width%3D%222%22%20fill%3D%22%23FFF%22%2F%3E%3Cpath%20d%3D%22M209%20190c19.329966%200%2035-15.670034%2035-35%200-6.778199-1.926799-13.106371-5.262556-18.466673C232.560339%20126.6072%20221.551767%20120%20209%20120c-19.329966%200-35%2015.670034-35%2035s15.670034%2035%2035%2035zm-93%2090c19.329966%200%2035-15.670034%2035-35%200-6.778199-1.926799-13.106371-5.262556-18.466673C139.560339%20216.6072%20128.551767%20210%20116%20210c-19.3299662%200-35%2015.670034-35%2035s15.6700338%2035%2035%2035zm373-90c19.329966%200%2035-15.670034%2035-35%200-6.778199-1.926799-13.106371-5.262556-18.466673C512.560339%20126.6072%20501.551767%20120%20489%20120c-19.329966%200-35%2015.670034-35%2035s15.670034%2035%2035%2035z%22%20stroke%3D%22currentColor%22%20stroke-width%3D%222%22%2F%3E%3Ctext%20font-family%3D%22RobotoMono-Light%2C%20Roboto%20Mono%22%20font-size%3D%2240%22%20font-weight%3D%22300%22%20fill%3D%22currentColor%22%3E%3Ctspan%20x%3D%22464.996094%22%20y%3D%22171%22%3E36%3C%2Ftspan%3E%3C%2Ftext%3E%3Ctext%20font-family%3D%22RobotoMono-Light%2C%20Roboto%20Mono%22%20font-size%3D%2238%22%20font-weight%3D%22300%22%20fill%3D%22currentColor%22%3E%3Ctspan%20x%3D%22174.794434%22%20y%3D%22170%22%3E100%3C%2Ftspan%3E%3C%2Ftext%3E%3Ctext%20font-family%3D%22RobotoMono-Light%2C%20Roboto%20Mono%22%20font-size%3D%2240%22%20font-weight%3D%22300%22%20fill%3D%22currentColor%22%3E%3Ctspan%20x%3D%2291.9960938%22%20y%3D%22261%22%3E17%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20d%3D%22M305%20280c19.329966%200%2035-15.670034%2035-35%200-6.778199-1.926799-13.106371-5.262556-18.466673C328.560339%20216.6072%20317.551767%20210%20305%20210c-19.329966%200-35%2015.670034-35%2035s15.670034%2035%2035%2035z%22%20stroke%3D%22currentColor%22%20stroke-width%3D%222%22%2F%3E%3Ctext%20font-family%3D%22RobotoMono-Light%2C%20Roboto%20Mono%22%20font-size%3D%2238%22%20font-weight%3D%22300%22%20fill%3D%22currentColor%22%3E%3Ctspan%20x%3D%22282.196289%22%20y%3D%22260%22%3E19%3C%2Ftspan%3E%3C%2Ftext%3E%3Ctext%20font-family%3D%22RobotoMono-Light%2C%20Roboto%20Mono%22%20font-size%3D%2238%22%20font-weight%3D%22300%22%20fill%3D%22currentColor%22%3E%3Ctspan%20x%3D%22314.794434%22%20y%3D%2270%22%3E120%3C%2Ftspan%3E%3C%2Ftext%3E%3Cpath%20d%3D%22M324.305402%2081L231%20127.270754M375%2081l89.005263%2049.575516M141%20220l43.724368-39m50.005479-1.977491l46.072795%2041.367311%22%20stroke%3D%22currentColor%22%20stroke-width%3D%222%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E)

The tree is now a heap again!

---
## Practice

Where will the next node be inserted in the heap?
```
        50
      /    \
    20      45
  /    \   /   \
 15    18  C    D
  A     B      
???
```

* `C`
* `A`
* `B`
* `D`

---
## Revision

In a `max-heap`, during upheap operation, the child swaps places with its parent if its value

???.

* is larger than the parent's
* is smaller than the parent's
* is equal to the parent's
* is the smallest in the whole heap

---
## Footnotes
[1: Complete heap]
Complete means that every level of the underlying binary tree structure is filled, except possibly the last level.
 
